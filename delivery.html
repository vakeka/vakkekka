<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Puff&Go ‚Äî –î–æ—Å—Ç–∞–≤—â–∏–∫</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    body {
      background: #0e0e10;
      color: #fff;
      font-family: "Inter", sans-serif;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px;
    }
    .info-box {
      background: rgba(255,255,255,0.05);
      padding: 20px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .btn {
      display: inline-block;
      background: #4c8bf5;
      color: #fff;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      margin: 10px;
      cursor: pointer;
      text-decoration: none;
      transition: 0.3s;
    }
    .btn:hover { background: #3a6fd9; }
    .btn-orange {
      background: #ff9800;
      color: #fff;
    }
    .btn-orange:hover {
      background: #e68900;
    }
  </style>
</head>
<body class="delivery">
  <header class="site-header">
    <div class="logo">Puff&Go</div>
    <nav class="nav">
      <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="liquids.html">–ñ–∏–¥–∫–æ—Å—Ç–∏</a>
      <a href="devices.html">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</a>
    </nav>
  </header>

  <main class="container">
    <h1>üì¶ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –¥–æ—Å—Ç–∞–≤—â–∏–∫–∞</h1>
    <div id="deliveryInfo" class="info-box"></div>

    <div style="margin-top:20px;text-align:center;">
      <button id="copyAll" class="btn">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
      <a href="https://t.me/PuffGoManager" target="_blank" class="btn">üì≤ –û—Ç–∫—Ä—ã—Ç—å Telegram</a>
      <button id="cancelOrder" class="btn" style="background:#f54c4c;">‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑</button>
      <button id="goHome" class="btn" style="background:#4caf50;">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
      <button id="goProducts" class="btn btn-orange">üîÑ –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ç–æ–≤–∞—Ä–∞–º</button>
    </div>
  </main>

  <script>
    const data = JSON.parse(localStorage.getItem("lastOrder"));
    const box = document.getElementById("deliveryInfo");

    if (data) {
 
      const items = Array.isArray(data.items) ? data.items : [{ code: data.flavorCode || data.flavor || '', qty: Number(data.qty || 1) }];
      const unitPrice = data.price ? (Number(data.price) || 0) : 15;
      const totalPrice = items.reduce((sum, item) => sum + (item.qty * unitPrice), 0);

      let msg = `üì¶ –ù–æ–≤—ã–π –∑–∞–∫–∞–∑:<br><br>`;
      msg += `üìÖ –î–∞—Ç–∞: ${data.date}<br>`;
      msg += `‚è∞ –í—Ä–µ–º—è: ${data.time}<br>`;
      msg += `üì¶ –ö–æ–ª-–≤–æ –ø–æ –≤–∫—É—Å–∞–º:<br>`;
      items.forEach(item => {
        msg += `- ${item.code}: ${item.qty} —à—Ç.<br>`;
      });
      msg += `üí∞ –¶–µ–Ω–∞ –∑–∞ 1 —à—Ç: ${unitPrice}‚Ç¨<br>`;
      msg += `üí∞ –ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞: <strong>${totalPrice}‚Ç¨</strong><br>`;

      box.innerHTML = msg;

      document.getElementById("copyAll").addEventListener("click", () => {
        let textToCopy = `\nüìÖ –î–∞—Ç–∞: ${data.date}\n‚è∞ –í—Ä–µ–º—è: ${data.time}\nüì¶ –ö–æ–ª-–≤–æ –ø–æ –≤–∫—É—Å–∞–º:\n`;
        items.forEach(item => {
          textToCopy += `- ${item.code}: ${item.qty} —à—Ç.\n`;
        });
        textToCopy += `üí∞ –¶–µ–Ω–∞ –∑–∞ 1 —à—Ç: ${unitPrice}‚Ç¨\nüí∞ –ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞: ${totalPrice}‚Ç¨\n`;
        navigator.clipboard.writeText(textToCopy.trim());
        alert("–î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã!");
      });

      document.getElementById("cancelOrder").addEventListener("click", () => {
        localStorage.removeItem("lastOrder");
        box.innerHTML = "–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω—ë–Ω.";
        alert("–ó–∞–∫–∞–∑ –±—ã–ª —É—Å–ø–µ—à–Ω–æ –æ—Ç–º–µ–Ω—ë–Ω!");
      });

      document.getElementById("goProducts").addEventListener("click", () => {
        if (data.type === "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ") {
          window.location.href = "devices.html";
        } else if (data.type === "–ñ–∏–¥–∫–æ—Å—Ç—å") {
          window.location.href = "liquids.html";
        }
      });

    } else {
      box.innerHTML = "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–µ.";
    }

    const goHomeBtn = document.getElementById("goHome");
    goHomeBtn.addEventListener("click", () => {
      localStorage.removeItem("lastOrder");
      window.location.href = "index.html";
    });
  </script>
</body>
</html>